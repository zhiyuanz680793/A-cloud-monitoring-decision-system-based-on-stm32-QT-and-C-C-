# STM32 + QT 云监控决策系统

基于 STM32 单片机和 Qt 的嵌入式温度风扇控制及云端监控系统

---

## 项目简介

本项目通过 STM32 采集热敏电阻和电位器数据，使用 DMA 方式进行 ADC 采样，结合 OLED 实时显示和按键手动控制风扇转速；同时通过USART协议串口与上位机 Qt 软件通信，实现数据云端监控和决策控制。

---

## 主要功能

- STM32 端  
  - ADC 多次采样平均，热敏电阻温度检测  
  - DMA 自动传输 ADC 数据  
  - OLED 显示温度、电压、风扇转速和模式状态  
  - 按键切换手动/自动风扇控制模式  
  - PWM 控制风扇转速  
  - 串口数据收发与上位机通信

- 上位机 Qt 软件  
  - 串口数据接收与显示  
  - 数据上传云端和实时监控  
    
---

## 硬件环境

本项目基于 STM32F103C8T6 微控制器开发，搭配多种传感器与执行器，实现环境监测与控制功能。主要硬件包括：

- **STM32F103C8T6**：主控芯片，负责数据采集、处理和通信控制。
- **热敏电阻（NTC）传感器**：用于温度检测，采集环境温度变化。
- **光敏电阻传感器**：用于环境光强度检测。
- **OLED 显示屏（0.96寸，128×64分辨率）**：实时显示传感器数据及系统状态。
- **直流风扇电机**：通过 PWM 信号调节转速，实现温度调节功能。
- **按键输入模块**：用于用户交互，切换风扇工作模式和调节参数。
- **串口通信模块（UART）**：与上位机（Qt 客户端）进行数据通信，实现远程监控和控制。

硬件模块间通过 GPIO 和 ADC 接口连接，STM32 内置 ADC 支持多通道采样并配合 DMA 实现高效数据传输。

---

## 软件环境

- Keil MDK-ARM 5  
- STM32 标准外设库  
- Qt 5.x (用于上位机界面)  

---
## 架构图
```
+--------------------------------------------------------+
|                     云端服务器 (Linux, C++)           |
|  • 高性能 TCP 服务器（epoll）                          |
|  • 接收上位机温度数据                                   |
|  • 分析后下发控制指令                                   |
|  • 将温度数据和控制指令进行记录和转发                   |
+--------------------------------------------------------+
                     ↑             ↑
                socket(TCP)   socket(TCP)
                     ↓             ↓
+--------------------------------------------------------+
|           上位机（Qt Creator GUI）                    |
|  • Qt GUI 显示温度、风扇状态                             |
|  • 与 STM32 下位机：串口通信（UART）                     |
|  • 与服务器通信：socket TCP                              |
+--------------------------------------------------------+
                     ↑
                  UART
                     ↓
+--------------------------------------------------------+
|           下位机 STM32F103C8T6 开发板                   |
|  • 采集模块：ADC + DMA + 热敏电阻                        |
|  • 执行模块：PWM 控制直流风扇                           |
|  • 显示模块：OLED 显示温度、模式（I2C）                  |
|  • 控制模块：按键切换自动/手动模式                      |
|  • 通信模块：UART 与上位机通信（中断）                   |
+--------------------------------------------------------+
```
---

## 代码结构
```
STM32_Firmware/
├── Core/
│ ├── main.c # 主程序入口，系统初始化和主循环逻辑
│ ├── adc.c # ADC 采集及 DMA 配置与读取
│ ├── motor.c # 风扇电机控制（PWM驱动、转速设置）
│ ├── oled.c # OLED 显示驱动与界面刷新
│ ├── key.c # 按键扫描与状态管理
│ ├── serial.c # 串口通信初始化及收发函数
│ └── control.c # 风扇转速控制算法（自动/手动模式切换）
├── Inc/
│ ├── adc.h # ADC 和DMA 模块头文件
│ ├── motor.h # 风扇控制相关头文件
│ ├── oled.h # OLED 驱动相关头文件
│ ├── key.h # 按键模块头文件
│ ├── serial.h # 串口通信模块头文件
│ └── control.h # 控制逻辑头文件
├── Qt_Client/ # Qt 上位机项目文件夹
│ ├── main.cpp # Qt 主程序入口
│ ├── serialhandler.cpp # 串口通信处理
│ ├── ui/ # 界面文件与资源
│ └── ... # 其他上位机代码
├── sever # 服务器的源代码
└── README.md # 项目说明文档
```





